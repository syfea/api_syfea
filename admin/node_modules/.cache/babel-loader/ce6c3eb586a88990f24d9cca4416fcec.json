{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nvar _HttpError = _interopRequireDefault(require(\"ra-core/lib/util/HttpError\"));\n\nvar _fetchJsonLd = _interopRequireDefault(require(\"@api-platform/api-doc-parser/lib/hydra/fetchJsonLd\"));\n\nvar _parseHydraDocumentation = require(\"@api-platform/api-doc-parser/lib/hydra/parseHydraDocumentation\");\n\nvar _jsonld = require(\"jsonld\");\n/**\n * Sends HTTP requests to a Hydra API.\n *\n * Adapted from react-admin\n *\n * @copyright KÃ©vin Dunglas\n *\n * @param {string} url\n * @param {object} options\n * @return {object}\n */\n\n\nvar _default = function _default(url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var requestHeaders = options.headers || new Headers();\n\n  if (options.user && options.user.authenticated && options.user.token) {\n    requestHeaders.set('Authorization', options.user.token);\n  }\n\n  return (0, _fetchJsonLd.default)(url, (0, _objectSpread2.default)({}, options, {\n    headers: requestHeaders\n  })).then(function (data) {\n    var status = data.response.status;\n\n    if (status < 200 || status >= 300) {\n      return _jsonld.promises.expand(data.body, {\n        base: (0, _parseHydraDocumentation.getDocumentationUrlFromHeaders)(data.response.headers)\n      }).then(function (json) {\n        return Promise.reject(new _HttpError.default(json[0]['http://www.w3.org/ns/hydra/core#description'][0]['@value'], status));\n      }).catch(function (e) {\n        if (e.hasOwnProperty('body')) {\n          return Promise.reject(e);\n        }\n\n        return Promise.reject(new _HttpError.default(data.response.statusText, status));\n      });\n    }\n\n    return {\n      status: status,\n      headers: data.response.headers,\n      json: data.body\n    };\n  });\n};\n\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}